<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stanza 7</title>

<style>
html, body{
overflow-x:hidden;
}

body{
font-family:Arial;
background:linear-gradient(135deg,#00416a,#799f0c);
margin:0;
padding:0;
text-align:center;
color:white;
}

h1{margin-top:25px;}

p{
opacity:.92;
margin:10px 15px;
}

/* GRIGLIA SEMPRE 2x2 */
.grid{
display:grid;
grid-template-columns:1fr 1fr;
gap:18px;
width:92%;
max-width:820px;
margin:22px auto;
}

.dropzone{
background:rgba(255,255,255,0.15);
border:3px dashed rgba(255,255,255,0.6);
border-radius:12px;
padding:16px;
min-height:150px;
display:flex;
align-items:center;
justify-content:center;
flex-direction:column;
transition:.3s;
font-weight:bold;
box-sizing:border-box;
}

.dropzone.correct{
border-color:#28a745;
background:rgba(40,167,69,0.3);
}

.dropzone.wrong{
border-color:#dc3545;
background:rgba(220,53,69,0.3);
}

.flag{
font-size:48px;
margin-bottom:8px;
}

.country{
font-size:15px;
line-height:1.2;
}

/* DRAGGABLES */
.draggables{
display:flex;
flex-wrap:wrap;
justify-content:center;
gap:12px;
margin:22px 10px 28px 10px;
min-height:60px;
}

.draggable{
background:#1a73e8;
padding:12px 14px;
border-radius:10px;
cursor:grab;
max-width:300px;
user-select:none;
touch-action:none;
font-weight:bold;
font-size:14px;
}

.drag-preview{
position:fixed;
z-index:9999;
pointer-events:none;
opacity:.95;
background:#1a73e8;
padding:12px 14px;
border-radius:10px;
font-weight:bold;
font-size:14px;
max-width:300px;
}

/* MOBILE: TUTTO SEMPRE VISIBILE */
@media (max-width:768px){

h1{
font-size:20px;
margin-top:15px;
}

p{
font-size:13px;
margin:8px 12px;
}

/* resta 2 colonne */
.grid{
gap:10px;
width:96%;
margin:14px auto;
}

/* box ridotti */
.dropzone{
min-height:110px;
padding:10px;
border-width:2px;
}

.flag{
font-size:34px;
margin-bottom:6px;
}

.country{
font-size:13px;
}

/* etichette pi√π piccole */
.draggables{
gap:8px;
margin:14px 6px 20px 6px;
}

.draggable{
font-size:12.5px;
padding:9px 10px;
max-width:170px;
}

.drag-preview{
font-size:12.5px;
padding:9px 10px;
max-width:170px;
}
}
</style>
</head>

<body>

<h1>‚úàÔ∏è Stanza 7</h1>
<p>Associa ogni Paese al documento minimo necessario per viaggiare.</p>

<div class="grid">

<div class="dropzone" data-match="schengen">
<div class="flag">üá™üá∫</div>
<div class="country">Area Schengen</div>
</div>

<div class="dropzone" data-match="uk">
<div class="flag">üá¨üáß</div>
<div class="country">Regno Unito</div>
</div>

<div class="dropzone" data-match="usa">
<div class="flag">üá∫üá∏</div>
<div class="country">Stati Uniti</div>
</div>

<div class="dropzone" data-match="cina">
<div class="flag">üá®üá≥</div>
<div class="country">Cina</div>
</div>

</div>

<div class="draggables" id="draggables">

<!-- ORDINE MESCOLATO -->
<div class="draggable" data-doc="cina">
Passaporto + Visto
</div>

<div class="draggable" data-doc="schengen">
Carta d‚Äôidentit√† (valida per l‚Äôespatrio)
</div>

<div class="draggable" data-doc="uk">
Passaporto
</div>

<div class="draggable" data-doc="usa">
Passaporto + ESTA
</div>

</div>

<script>
let draggedItem = null;
let preview = null;

let grabOffsetX = 0;
let grabOffsetY = 0;

document.querySelectorAll(".draggable").forEach(item=>{
  item.addEventListener("pointerdown", startDrag);
});

function startDrag(e){

  e.preventDefault();

  draggedItem = e.currentTarget;

  const rect = draggedItem.getBoundingClientRect();
  grabOffsetX = e.clientX - rect.left;
  grabOffsetY = e.clientY - rect.top;

  preview = draggedItem.cloneNode(true);
  preview.classList.add("drag-preview");
  document.body.appendChild(preview);

  movePreview(e);

  draggedItem.setPointerCapture(e.pointerId);

  document.addEventListener("pointermove", movePreview);
  document.addEventListener("pointerup", endDrag);
}

function movePreview(e){
  if(!preview) return;

  preview.style.left = (e.clientX - grabOffsetX) + "px";
  preview.style.top  = (e.clientY - grabOffsetY) + "px";
}

function endDrag(e){

  if(!preview) return;

  let targetZone = null;

  document.querySelectorAll(".dropzone").forEach(zone=>{
    const rect = zone.getBoundingClientRect();

    if(
      e.clientX > rect.left &&
      e.clientX < rect.right &&
      e.clientY > rect.top &&
      e.clientY < rect.bottom
    ){
      targetZone = zone;
    }
  });

  preview.remove();
  preview = null;

  document.removeEventListener("pointermove", movePreview);
  document.removeEventListener("pointerup", endDrag);

  if(!targetZone){
    draggedItem = null;
    return;
  }

  if(targetZone.classList.contains("correct")){
    draggedItem = null;
    return;
  }

  if(targetZone.dataset.match === draggedItem.dataset.doc){

    targetZone.appendChild(draggedItem);
    draggedItem.style.pointerEvents = "none";
    targetZone.classList.add("correct");

    checkWin();

  }else{

    targetZone.classList.add("wrong");
    setTimeout(()=>{
      targetZone.classList.remove("wrong");
    },600);

  }

  draggedItem = null;
}

function checkWin(){
  let correct = document.querySelectorAll(".dropzone.correct").length;
  if(correct === 4){
    setTimeout(()=>{
      window.location.href="stanza8.html";
    },900);
  }
}
</script>

</body>
</html>
