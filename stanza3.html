<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stanza 4</title>

<style>
body{
font-family:Arial;
background:#f4f4f4;
text-align:center;
margin:0;
padding:0;
}

h1{margin-top:30px;}
p{margin-bottom:20px;}

.image-wrapper{
position:relative;
display:inline-block;
width:80%;
max-width:1000px;
}

.image-wrapper img{
width:100%;
border-radius:12px;
display:block;
}

/* HOTSPOT */
.hotspot{
position:absolute;
width:28px;
height:28px;
border-radius:50%;
background:#fff;
border:2px solid #ccc;
cursor:pointer;
transform:translate(-50%,-50%);
transition:.2s;
z-index:5;
}

.hotspot:hover{
transform:translate(-50%,-50%) scale(1.15);
box-shadow:0 0 8px rgba(0,0,0,.3);
}

.hotspot::after{
content:"";
position:absolute;
top:50%;
left:50%;
width:10px;
height:10px;
background:#555;
border-radius:50%;
transform:translate(-50%,-50%);
}

/* TOOLTIP */
.tooltip{
position:absolute;
min-width:260px;
background:#fff;
padding:15px;
border-radius:12px;
box-shadow:0 8px 25px rgba(0,0,0,.25);
font-size:14px;
text-align:left;
opacity:0;
visibility:hidden;
z-index:9999;
transition:opacity .2s ease;
}

.tooltip.active{
opacity:1;
visibility:visible;
}

.tooltip a{
display:block;
margin-top:10px;
font-weight:bold;
color:#1a73e8;
text-decoration:underline;
}

/* MOBILE */
@media (max-width:768px){

.image-wrapper{width:95%;}

.hotspot{
width:36px;
height:36px;
}

.tooltip{
position:fixed !important;
bottom:20px !important;
left:50% !important;
transform:translateX(-50%) !important;
width:90%;
max-width:420px;
}
}

/* MOBILE PANEL */
.mobile-panel{
display:none;
margin:30px auto;
width:92%;
max-width:500px;
background:#ffffff;
padding:20px;
border-radius:16px;
box-shadow:0 10px 25px rgba(0,0,0,.12);
text-align:left;
}

.progress-bar{
background:#eee;
height:8px;
border-radius:10px;
margin-top:8px;
overflow:hidden;
}

.progress-fill{
width:40%;
height:8px;
background:#1a73e8;
}

.timer{
margin-top:15px;
font-weight:bold;
}

@media (max-width:768px) and (orientation:portrait){
.mobile-panel{display:block;}
}
</style>
</head>

<body>

<h1>Stanza 4</h1>
<p>Individua la molecola che NON è un polimero.</p>

<div class="image-wrapper">
<img src="Molecole.jpg">

<!-- Polietilene -->
<div class="hotspot"
style="top:25%; left:25%;"
data-testo="Polietilene (PE): polimero sintetico formato dalla ripetizione dell’unità –CH₂–CH₂–."
data-link="errore.html"></div>

<!-- Nylon -->
<div class="hotspot"
style="top:25%; left:75%;"
data-testo="Nylon: polimero sintetico contenente gruppi ammidici –CONH– nella catena principale."
data-link="errore.html"></div>

<!-- PVC -->
<div class="hotspot"
style="top:75%; left:25%;"
data-testo="PVC: polimero derivato dal cloruro di vinile, caratterizzato dall’unità ripetitiva –CH₂–CHCl–."
data-link="errore.html"></div>

<!-- Glucosio -->
<div class="hotspot"
style="top:75%; left:75%;"
data-testo="Glucosio (C₆H₁₂O₆): monosaccaride, molecola organica semplice, non costituita da unità ripetitive."
data-link="stanza5.html"></div>

</div>

<!-- MOBILE PANEL -->
<div class="mobile-panel">

<h3>Missione</h3>
<p>Analizza la struttura molecolare e individua l’intruso.</p>

<div>
<div>Livello 4 di 10</div>
<div class="progress-bar">
<div class="progress-fill"></div>
</div>
</div>

<div class="timer">
Tempo totale: <span id="timer">00:00</span>
</div>

</div>

<script>

/* TIMER GLOBALE */
function aggiornaTimer(){
let start = parseInt(localStorage.getItem("startTime"));
if(!start) return;

let now = Date.now();
let diff = Math.floor((now - start)/1000);

let min = Math.floor(diff/60);
let sec = diff%60;

let el = document.getElementById("timer");
if(el){
el.innerText =
String(min).padStart(2,'0')+":"+
String(sec).padStart(2,'0');
}
}

setInterval(aggiornaTimer,1000);
aggiornaTimer();

/* HOTSPOT */
document.querySelectorAll(".hotspot").forEach(function(h){

const tooltip=document.createElement("div");
tooltip.className="tooltip";
tooltip.innerHTML=
h.dataset.testo+
'<a href="'+h.dataset.link+'">Seleziona</a>';

document.body.appendChild(tooltip);

h.addEventListener("click",function(e){
e.stopPropagation();

document.querySelectorAll(".tooltip").forEach(t=>t.classList.remove("active"));

if(window.innerWidth > 768){
const rect = h.getBoundingClientRect();
tooltip.style.position="absolute";
tooltip.style.top = rect.top + window.scrollY + "px";
tooltip.style.left = rect.left + window.scrollX + "px";
}else{
tooltip.style.position="fixed";
tooltip.style.bottom="20px";
tooltip.style.left="50%";
tooltip.style.transform="translateX(-50%)";
}

tooltip.classList.add("active");
});

});

document.addEventListener("click",function(){
document.querySelectorAll(".tooltip").forEach(t=>t.classList.remove("active"));
});

</script>

</body>
</html>
